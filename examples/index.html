<!DOCTYPE html>

<html>
<head>
    <title></title>
    <script src="../dist/wMessenger.min.js" type="text/javascript"></script>
</head>
<body>
    <table style="width:100%;height:500px;">
        <tr>
            <td style="width: 33%;vertical-align:top;">
                <p>
                    填写广播数据
                </p>
                <textarea id="j-bdata" style="width:400px;height:400px;"></textarea>
                <p>
                    <button id="j-broadcast">广播通知</button>
                </p>
            </td>
            <td style="width: 33%;vertical-align:top;">
                <p>框架页1</p>
                <iframe src="frame1.html" style="width:90%;border:none;height:450px;"></iframe>
            </td>
            <td style="vertical-align:top;">
                <p>框架页2</p>
                <iframe src="frame2.html" style="width:90%;border:none;height:450px;"></iframe>
            </td>
        </tr>
    </table>

    <script>
        var jbroadcast = document.getElementById("j-broadcast");
        var jbdata = document.getElementById("j-bdata");

        jbroadcast.addEventListener("click", function(){
            
            var bdata = jbdata.value;

            if(/^\{.*\}$/.test(bdata) || /^\[.*\]$/.test(bdata)){
                bdata = eval('(' + bdata + ')');
            }
            
            wMessenger.broadcast({
                key: "test",
                data: bdata
            });
        });
    </script>
</body>
</html>