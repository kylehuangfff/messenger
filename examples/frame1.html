<!DOCTYPE html>

<html>
<head>
    <title></title>
    <script src="../dist/wMessenger.min.js" type="text/javascript"></script>
</head>
<body>
    <p>接收到的数据：</p>
    <textarea style="width:100%;height:300px;" id="j-area"></textarea>
    <p>
        <button id="j-addEvent">开始监听</button>
        <button id="j-removeEvent" style="display:none;">取消监听</button>
    </p>

    <script>

        var area = document.getElementById("j-area");
        var jadd = document.getElementById("j-addEvent");
        var jremove = document.getElementById("j-removeEvent");
        var guid;

        jadd.addEventListener("click", function(){
            guid = wMessenger.addListener({
                key: "test",
                cb: function(data){
                    area.value = JSON.stringify(data);
                }
            });

            jadd.style.display = "none";
            jremove.style.display = "";
        }, false);

        jremove.addEventListener("click", function(){
            wMessenger.removeListener(guid);

            jadd.style.display = "";
            jremove.style.display = "none";
        }, false);
    </script>
</body>
</html>